# Figma AI Analyzer 调试指南

## 问题排查步骤

### 1. 确认扩展已正确加载
1. 打开 `chrome://extensions/`
2. 确认扩展已启用
3. 检查是否有错误提示

### 2. 在Figma页面中测试
1. 打开 `https://www.figma.com/design/xxxx` (设计文件页面)
2. 按 F12 打开开发者工具
3. 在 Console 标签中查看日志
4. 应该能看到：
   - "Figma Analyzer Content Script 已加载"
   - "Figma Analyzer 注入脚本已加载"
   - "Figma API 可用" 或 "Figma API 不可用，将使用页面文本提取作为备用方案"

### 3. 测试文案提取
1. 在Figma中选中一些设计元素
2. 点击扩展图标，打开弹窗
3. 点击"获取Figma选中元素"
4. 在开发者工具 Console 中查看：
   - "找到Figma选中元素:" 
   - "从Figma API提取到的文案:" 或 "备用方案提取到的文案:"

### 4. API密钥配置
1. 确认已在 https://platform.deepseek.com/ 注册账号
2. 获取API密钥：sk-xxxxxxxxx
3. 在扩展弹窗中输入API密钥并保存

### 5. 测试AI分析
1. 成功获取文案后，点击"开始AI分析"
2. 在开发者工具中查看：
   - Network标签：查看API请求是否成功
   - Console标签：查看"原始AI响应"和"解析成功的结果"

## 常见问题解决

### Q1: 显示"无法解析AI分析结果"
**原因**: AI API调用失败或返回格式错误
**解决**:
1. 检查API密钥是否正确
2. 检查网络连接
3. 查看开发者工具中的错误信息
4. 确认DeepSeek账户余额充足

### Q2: 无法获取Figma元素
**原因**: Figma API访问失败
**解决**:
1. 确认在Figma设计文件页面（不是团队页面）
2. 在Figma中选中一些元素
3. 检查控制台是否有错误
4. 扩展会自动使用备用方案提取页面文本

### Q3: 提取的文案为空
**原因**: 
- 选中的元素中没有文本
- Figma API访问受限
**解决**:
1. 确保选中包含文本的元素
2. 扩展支持备用方案，会提取页面所有可见文本

## 新功能说明

### 🎯 专注文案分析
- 递归提取所有文本内容
- 智能识别标题、按钮、描述等文案类型
- 提供文案质量分析和优化建议

### 📊 改进的数据显示
- 分别显示"提取的文案内容"和"元素结构"
- 显示文案数量统计
- 提供字体信息

### 🔧 增强的错误处理
- 详细的调试日志
- 备用方案自动启用
- 更好的错误信息提示

## 测试数据格式

成功运行后，您应该看到类似这样的JSON输出：

```json
{
  "pageType": "产品介绍页",
  "description": "这是一个产品功能介绍页面，包含标题、功能说明和行动引导",
  "textAnalysis": {
    "totalTexts": "5",
    "mainTexts": ["产品名称", "核心功能介绍"],
    "buttons": ["立即体验", "了解更多"],
    "descriptions": ["详细功能说明文案"],
    "navigation": ["首页", "产品", "价格"]
  },
  "elements": [
    {
      "id": "xxx",
      "text": "立即体验",
      "purpose": "行动引导按钮",
      "quality": "简洁有力，符合行动导向原则",
      "recommendations": ["可考虑添加紧迫感词汇"]
    }
  ],
  "suggestions": ["整体文案层次清晰", "建议增加用户价值描述"],
  "timestamp": "2024-12-13T13:20:12.313Z"
}
```

如果仍有问题，请在开发者工具中复制完整的错误信息。 
